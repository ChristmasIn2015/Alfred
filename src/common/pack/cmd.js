var E=Object.defineProperty;var g=e=>E(e,"__esModule",{value:!0});var a=(e,i)=>{for(var t in i)E(e,t,{get:i[t],enumerable:!0})};g(exports);a(exports,{excuteCmd:()=>h,killCmd:()=>m});var n;(function(e){e.WHITE="white",e.GREEN="green",e.YELLOW="yellow",e.RED="red"})(n||(n={}));function h(e,i){if(e=e.replace(/\n/g," "),T(e)){let s=global.$common.getFullTime().full;i({pid:null,text:`@Node(${process.pid}) Danger Cmd: ${e}`,html:r(n.RED,`@Node(${process.pid}) Danger Cmd: ${e}`,s)});return}let t=require("child_process").exec(e,{maxBuffer:1024*1024*1024},(s,c,$)=>{let d=`@Node(${process.pid}) Cmd(${t.pid})`,o=global.$common.getFullTime().full,l={pid:null,text:`${d} Task end`,html:r(n.GREEN,d,`${d} Task end`,o)};s?(l.text=`${d} Command error:${s.message}`,l.html=r(n.RED,d,l.text,o)):$&&(l.text=`${d} Task error:${$.message}`,l.html=r(n.RED,d,l.text,o)),i(l)}),u="latin1";t.stdout.setEncoding(t.stdout.readableEncoding);let p="utf8",f=`@Node(${process.pid}) Cmd(${t.pid}) Task start\uFF1A${u}=>${p}`,x=require("iconv-lite");return i({pid:t.pid,text:f,html:r(n.GREEN,f)}),t.stdout.on("data",s=>{let c=x.decode(Buffer.from(`@Log(${t.pid}) ${s}`,u),p);i({pid:t.pid,text:c,html:r(n.WHITE,c)}),s.includes("Merge conflict")&&m(t.pid)}),t.pid}function m(e){require("tree-kill")(e)}function T(e){e=e.trim().toUpperCase();let i=!1;return e.length===0&&(i=!0),e.indexOf("SSH")>=0&&(i=!0),i}function r(e,...i){let t="";return i.forEach(u=>t+=`<div style="color:${e}">${u}</div>`),t}
