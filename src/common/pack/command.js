var m=Object.defineProperty;var E=e=>m(e,"__esModule",{value:!0});var a=(e,i)=>{E(e);for(var t in i)m(e,t,{get:i[t],enumerable:!0})};a(exports,{cmd:()=>b,cmdDestory:()=>h});var r;(function(e){e.WHITE="white",e.GREEN="green",e.YELLOW="yellow",e.RED="red"})(r||(r={}));function b(e,i){if(e=e.replace(/\n/g," "),g(e)){let n=global.$common.getFullTime().full;i({pid:null,text:`@Node(${process.pid}) Danger Cmd: ${e}`,html:d(r.RED,`@Node(${process.pid}) Danger Cmd: ${e}`,n)});return}let t=require("child_process").exec(e,{maxBuffer:1024*1024*1024},(n,p,$)=>{let s=`@Node(${process.pid}) Cmd(${t.pid})`,f=global.$common.getFullTime().full,l={pid:null,text:`${s} \u4EFB\u52A1\u7ED3\u675F`,html:d(r.GREEN,s,"",f)};n?l.text=`${s} \u8FDB\u7A0B\u5F02\u5E38:${n.message}`:$&&(l.text=`${s} \u4EFB\u52A1\u5F02\u5E38:${$.message}`),l.html=d(r.RED,s,l.text,f),i(l)}),c=`@Node(${process.pid}) Cmd(${t.pid})`,u=t.stdout.readableEncoding,o="utf8",x=require("iconv-lite");return i({pid:t.pid,text:`${c} ${u}=>${o}:Start`,html:d(r.GREEN,`${c}) Start`)}),t.stdout.setEncoding("latin1"),t.stdout.on("data",n=>{let p=x.decode(Buffer.from(`@Log(${t.pid}) ${n}`,u),o);i({pid:t.pid,text:p,html:d(r.WHITE,p)}),n.includes("Merge conflict")&&require("tree-kill")(t.pid)}),t.pid}function h(e){require("tree-kill")(e)}function g(e){e=e.trim().toUpperCase();let i=!1;return e.length===0&&(i=!0),e.indexOf("SSH")>=0&&(i=!0),i}function d(e,...i){let t="";return i.forEach(c=>t+=`<span style="color:${e}">${c}</sapn><br>`),t}
